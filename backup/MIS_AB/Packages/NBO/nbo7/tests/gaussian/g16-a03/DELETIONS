
---------------------------------------------------
How to perform NBO deletions analysis with G16 A.03
---------------------------------------------------

The standard route for performing NBO deletions with G16 A.03 is
broken.  (This is fixed in the G16 B.01 release.)  One would generally
request deletions using the pop=nbo6del keyword, but the resulting
calculation fails.

We show you here how to prepare a "non-standard route" to successfully
perform this type of calculation with G16 A.03.

Consider the following calculation for methylamine.

-----------------------------------------------------------
 rhf/3-21g pop=nbo6del

Methylamine...rhf/3-21g//idealized geometry

0 1
C
N   1   1.47
H   1   1.09   2   109.4712
H   1   1.09   2   109.4712   3   120. 0
H   1   1.09   2   109.4712   3   240. 0
H   2   1.01   1   109.4712   3    60. 0
H   2   1.01   1   109.4712   3   300. 0

$nbo  $end
$del
  lewis                    ! discard all non-Lewis orbitals
  delete 1 element 3 11    ! LP-BD* interaction
$end

-----------------------------------------------------------

The standard route for this calculation requests NBO deletions for an
RHF/3-21G wavefunction.  Two deletions are specified in the $DEL
keylist, including (i) a re-evaluation of the energy with all
non-Lewis orbitals discarded, and (ii) the deletion of the Fock matrix
element describing the interaction of orbitals 3 and 11.  The broken
route for this calculation causes G16 to fail during the LEWIS
deletion.

To prepare a valid route for this calculation, add the Gaussian Link 0
command "%KJob L101" before the route section.

-----------------------------------------------------------
#KJob L101
# rhf/3-21g pop=nbo6del

Methyl...

-----------------------------------------------------------

Run this calculation.  Gaussian will terminate when Link 101 is done.

The broken route is reported in the Gaussian output file in the route
section.  Copy the broken route from the output to the input file, and
delete the %KJob Link 0 command.

The resulting input file should look like the following:

-----------------------------------------------------------
# nonstd
1/38=1,163=2/1;
2/12=2,17=6,18=5,40=1/2;
3/5=5,11=1,16=1,25=1,30=1,116=1/1,2,3;
4//1;
5/5=2,38=5/2;
6/7=2,8=2,9=2,10=2,28=1,40=12,113=1,114=1,124=2103/1,12(1);
99/5=1,9=1/99;
5/5=2,7=1,13=1,38=1,48=100000/2;
6/7=2,8=2,9=2,10=2,28=1,40=3,113=1,114=1,124=2103/12(-1);   (add this line)
99/5=1,9=1/99;
	  
Methylamine...rhf/3-21g//idealized geometry

0 1
C
N   1   1.47
H   1   1.09   2   109.4712
H   1   1.09   2   109.4712   3   120. 0
H   1   1.09   2   109.4712   3   240. 0
H   2   1.01   1   109.4712   3    60. 0
H   2   1.01   1   109.4712   3   300. 0

$nbo  $end
$del
  lewis                    ! discard all non-Lewis orbitals
  delete 1 element 3 11    ! LP-BD* interaction
$end

-----------------------------------------------------------

Note that the route card is changed to "#nonstd" to indicate that a
non-standard route will be used in this calculation.

Importantly, the parameters and sequence of links that appear in this
route encode the details of Gaussian's standard "# rhf/3-21g
pop=nbo6del" route.  This route is specific to RHF/3-21G calculations
with NBO deletions.  If you are using a method/basis set other than
RHF/3-21G, you must go through the %KJob step above to generate the
corresponding route.  Use the non-standard route shown above only for
RHF/3-21G.

Also note that one line is added near the end of the non-standard
route.  (It's this missing line that breaks the standard route for NBO
deletions with G16.)  This extra line is nearly identical to the one
three lines before it, but differs in three important ways:

6/7=2,8=2,9=2,10=2,28=1,40=12,113=1,114=1,124=2103/1,12(1);
                           ^                       ^    ^
6/7=2,8=2,9=2,10=2,28=1,40=3,113=1,114=1,124=2103/12(-1);
                           ^                     ^    ^

1.  Parameter IOp40 is set to 3 rather than 12.
2.  L601 is not called before L612.
3.  If a deletion is read, G16 cycles back one line (-1) in the route
    rather than skipping ahead one line (1).

The extra line in the route must be coded correctly for the deletions
calculation to be successful.

Output from this calculation is given in NBO7 distribution (see
nbo7/tests/gaussian/g16-a03/ch3nh2.arc).

Last updated: 2-Sep-2019
